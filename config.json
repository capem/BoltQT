{
  "_last_used_preset": "Preset: OV LOCAL",
  "Preset: OV LOCAL": {
    "document_type": "OV",
    "source_folder": "//192.168.0.77/tarec/Archive/SCANNER/OV LOCAL",
    "excel_file": "//192.168.0.77/tarec/Archive/Archive 2023/SUIVI OV CHQ OPCVM BC 2023.xlsx",
    "excel_sheet": "OV",
    "processed_folder": "//192.168.0.77/tarec/Archive/Archive 2023/OV/OV LOCAL",
    "skip_folder": "//192.168.0.77/tarec/Archive/SCANNER/OV LOCAL/SKIPPED",
    "output_template": "{processed_folder}/{filter6|date.year}/{filter6|date.year}-{filter6|date.month}/{filter2} {filter1}.pdf",
    "num_filters": 6,
    "filter_columns": [
      "FOURNISSEUR",
      "N° OV",
      "N° BC",
      "N° FACTURE",
      "MONTANT ",
      "DATE OV"
    ],
    "prompt": "Extract the following information from the provided set of documents, which may include a payment order (OV) and its supporting documents:\n1. Supplier/Beneficiary Name: Found on the main payment order.\n2. Payment Order Number (N° OV): Found on the main payment order, usually in the format 'TAREC-OV-YYYY-MM-NNNN'.\n3. Purchase Order Numbers (N° BC): A key field. Look for this number in supporting documents like 'Pièce de dépense (PDD)' or 'Fiche de contrôle interne (FCI)' next to 'BC N°'. This number is often NOT on the main payment order. The number is typically in the format 'YY-MM-NNNN'. Format the final output by prepending 'BC ' to the number, like 'BC 25-07-0001'. If there are multiple numbers separated by a slash (/), format them as a single string separated by semicolons, ensuring each number has the 'BC ' prefix (e.g., 'BC 25-06-0014; BC 25-06-0015'). If the field explicitly says 'Contrat', return the string 'Contrat'. If the field is empty, return null.\n4. Related Invoice Numbers: Found on the main payment order, usually after 'Motif:'. If there are multiple, separate them with semicolons.\n5. Total Amount: The total amount of the payment order, without the currency (e.g., '650,00').\n6. Date of Payment Order (DATE OV): The date on the main payment order document, in DD/MM/YYYY format.\n\nReturn ONLY a JSON object with these fields as keys:\n{\n    \"supplier_name\": \"extracted supplier/beneficiary name\",\n    \"order_number\": \"extracted payment order number\",\n    \"purchase_order_number\": \"extracted and formatted BC numbers, the word 'Contrat', or null\",\n    \"related_invoices\": \"extracted invoice references, semicolon-separated or null\",\n    \"total_amount\": \"extracted amount without currency\",\n    \"payment_date\": \"extracted date of payment order (format DD/MM/YYYY)\"\n}\n\nIf any field is not found, set its value to null.",
    "field_mappings": {
      "supplier_name": "filter1",
      "order_number": "filter2",
      "purchase_order_number": "filter3",
      "related_invoices": "filter4",
      "total_amount": "filter5",
      "payment_date": "filter6"
    },
    "vision": {
      "enabled": true,
      "gemini_api_key": "AIzaSyAE94QUchmv7tzGCNfNkDLkvaJVz3XcOZw",
      "model": "gemini-2.0-flash",
      "supplier_match_threshold": 0.75,
      "default_language": "fr",
      "ocr_preprocessing": true
    }
  },
  "Preset: Bon de Commande": {
    "document_type": "BC",
    "source_folder": "//192.168.0.77/tarec/Archive/SCANNER/BC",
    "processed_folder": "//192.168.0.77/tarec/Archive/Archive 2023/BC",
    "excel_file": "//192.168.0.77/tarec/Archive/Archive 2023/SUIVI OV CHQ OPCVM BC 2023.xlsx",
    "excel_sheet": "BON DE COMMANDE",
    "skip_folder": "//192.168.0.77/tarec/Archive/SCANNER/BC/SKIPPED",
    "output_template": "{processed_folder}/{filter3|date.year}/{filter3|date.year}-{filter3|date.month}/{filter2} {filter1}.pdf",
    "num_filters": 4,
    "filter_columns": [
      "FOURNISSEUR",
      "N\u00b0 BC",
      "DATE BC",
      "MONTANT"
    ],
    "prompt": "Extract the following information from this purchase order:\n1. Supplier/Vendor Name\n2. Purchase Order Number\n3. Purchase Order Date (in format DD/MM/YYYY)\n4. Total Amount (without currency)\n\nReturn ONLY a JSON object with these fields as keys:\n{\n    \"supplier_name\": \"extracted supplier name\",\n    \"order_number\": \"extracted purchase order number, generally in this format 'BC 25-01-0010'\",\n    \"order_date\": \"extracted date in DD/MM/YYYY format\",\n    \"total_amount\": \"extracted amount with currency 'Montant TTC'\"\n    }\n\nIf any field is not found in the image, set its value to null.",
    "field_mappings": {
      "supplier_name": "filter1",
      "invoice_number": "filter2",
      "invoice_date": "filter3",
      "total_amount": "filter4"
    },
    "vision": {
      "enabled": true,
      "gemini_api_key": "AIzaSyAE94QUchmv7tzGCNfNkDLkvaJVz3XcOZw",
      "model": "gemini-2.0-flash",
      "supplier_match_threshold": 0.75,
      "default_language": "fr",
      "ocr_preprocessing": true
    }
  },
  "Preset: Factures": {
    "document_type": "FA",
    "source_folder": "//192.168.0.77/tarec/Archive/SCANNER/FACTURE RECUES",
    "excel_file": "//192.168.0.77/tarec/Archive/Archive 2023/SUIVI OV CHQ OPCVM BC 2023.xlsx",
    "excel_sheet": "FACTURE",
    "processed_folder": "//192.168.0.77/tarec/Archive/Archive 2023/FACTURE RECU",
    "skip_folder": "//192.168.0.77/tarec/Archive/SCANNER/FACTURE RECUES/SKIPPED",
    "output_template": "{processed_folder}/{filter3|date.year}/MOIS {filter3|date.month}/{filter2|str.first_word} {filter1} {filter2|str.split_no_last}.pdf",
    "num_filters": 4,
    "filter_columns": [
      "FOURNISSEUR",
      "N\u00b0 FACTURE",
      "DATE FACTURE",
      "MONTANT"
    ],
    "prompt": "Extract the following information from this scanned invoice:\n1. Supplier/Vendor Name\n2. Extract the primary invoice identification number. If the extracted number does NOT begin with \"FA N\u00b0\", you must add \"FA N\u00b0\" at the start. (Example from \"20505088\" to \"FA N\u00b020505088\")\n3. Invoice Date (in format DD/MM/YYYY)\n4. Total Amount (using a dot (`.`) as the decimal separator, without currency or thousands separators)\n\nReturn ONLY a JSON object with these fields as keys:\n{\n    \"supplier_name\": \"extracted supplier name\",\n    \"invoice_number\": \"extracted invoice number\" (you must add \"FA N\u00b0\" at the start If the extracted number does NOT begin with \"FA N\u00b0\"),\n    \"invoice_date\": \"extracted date in DD/MM/YYYY format\",\n    \"total_amount\": \"extracted amount, dot (`.`) as the decimal separator, without currency or thousands separators\"\n}\n\nIf any field is not found in the image, set its value to null.",
    "field_mappings": {
      "supplier_name": "filter1",
      "invoice_number": "filter2",
      "invoice_date": "filter3",
      "total_amount": "filter4"
    },
    "vision": {
      "enabled": true,
      "gemini_api_key": "AIzaSyAE94QUchmv7tzGCNfNkDLkvaJVz3XcOZw",
      "model": "gemini-2.0-flash",
      "supplier_match_threshold": 0.75,
      "default_language": "fr",
      "ocr_preprocessing": true
    }
  }
}